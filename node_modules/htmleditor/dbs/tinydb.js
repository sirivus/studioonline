var tiny = require("tiny"),
    path = require("path"),
    dbpath = path.join(__dirname, "db");


var dbs = {};

["Navigation", "Article"].forEach(function (n) {

    tiny(path.join(dbpath, n), function (err, db) {
        dbs[n] = db;
        if(n === "Navigation"){
            db.get("id001",function(err,data){
                if(data){
                    var nav = require("../query").nav;
                    nav.reborn(data);
                }
            })
        }
    })
})

module.exports = {
    get: function (type, id, cb) {
        dbs[type].get(id, cb);
    },
    save: function (type, data, cb) {
        dbs[type].set(data.id, data, cb);
    },
    update: function (type, id, data, cb) {
        dbs[type].update(id, data, cb);
    },
    remove: function (type, id, cb) {
        dbs[type].remove(id, cb);
    },
    getDB: function (type) {
        console.log(dbs)
        return dbs[type];
    }
}

