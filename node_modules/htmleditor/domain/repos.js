
function wrap(Repository, Aggres,services) {

    var mapID = "id001";

    var articleRepo = new Repository("Article");

    articleRepo._create = function(data, callback){
        var service = services["typeExist"];
        service(data.type,function(bool){
            if(bool){
               var Article = Aggres.Article;
               var art = new Article(data.type,data.title,data.content);
               callback(undefined,art);
            }else{
               callback(new Error("type error!"))
            }
        })
    }

    articleRepo._data2aggre = function(data){

        var Article = Aggres.Article;
        var art = new Article(data.type,data.title,data.content);

        art._readCount = data.readCount;
        art._createTime = data.createTime;
        art._updateTime = data.updateTime;
        art._top = data.top;
        art._labels = data.labels;

        return art;

    }

    articleRepo._aggre2data = function(art){

        var data = {
            title:art._title,
            content:art._content,
            readCount:art._readCount,
            createTime:art._createTime,
            updateTime:art._updateTime,
            top:art._top,
            labels:art._labels,
            type:art._type
        }

        return data;

    }

    var mapRepo = new Repository("Navigation");

    mapRepo._create = function(data,callback){

         this.get(mapID,function(err,map){
             if(map){
                callback(new Error("must only one."));
             }else{
                var Navigation = Aggres.Navigation;
                map = new Navigation(mapID);
                callback(undefined,map);
             }
         })

    }

    mapRepo._aggre2data = function(aggre){
         return aggre.json;
    }

    mapRepo._data2aggre = function(data){
        var Navigation = Aggres.Navigation;
        var map = new Navigation(mapID);
        map.reborn(data);
        return map;
    }

    return [articleRepo,mapRepo];

}

module.exports = wrap;